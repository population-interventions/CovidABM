Parameters
  "illness_period" 21.2
  "se_illnesspd" 4
  "incubation_period" 4.7
  "se_incubation" 2.25

Global
  set Illness_Periodvariance se_Illnesspd
  set BetaIllnessPd ln (1 + (illness_PeriodVariance / illness_period ^ 2))
  set M (ln illness_period) - (BetaillnessPd / 2)
  set S sqrt BetaIllnessPd

  set Incubation_Periodvariance se_Incubation
  set BetaIncubationPd ln (1 + (incubation_PeriodVariance / incubation_period ^ 2))
  set MInc (ln incubation_period) - (BetaincubationPd / 2)
  set SInc sqrt BetaIncubationPd


Global Effects

BetaIllnessPd = ln(1 + 4 / 21.2^2) = 0.008861
M = ln(21.2) - BetaIllnessPd / 2 = 3.04957
S = sqrt(BetaIllnessPd) = 0.094131

BetaIncubationPd = ln(1 + 2.25 / 4.7^2) = 0.096996
MInc = ln(4.7) - BetaIncubationPd / 2 = 1.49906
SInc = sqrt(BetaIncubationPd) = 0.311442


Simulant
  set ownIllnessPeriod_raw ( exp random-normal M S ) ;; log transform of illness period
  set ownIncubationPeriod_raw ( exp random-normal Minc Sinc ) ;;; log transform of incubation period

  set ownIllnessPeriod ownIllnessPeriod_raw
  set ownIncubationPeriod ownIncubationPeriod_raw


Vaccination
  set transmitFromVacAndReinfect effect_raw ^ (1 / 2)
  set ownIllnessPeriod ownIllnessPeriod_raw * transmitFromVacAndReinfect
  set ownIncubationPeriod ownIncubationPeriod_raw * transmitFromVacAndReinfect


Virulence based on infection time (timenow)
  if timenow <= Non_Infective_Time [
    set currentVirulence 0
  ]
  ifelse ownIllnessPeriod > 0
  [
    if timenow > Non_Infective_Time and timenow <= ownIncubationPeriod [
      set currentVirulence variantTransMult * personalVirulence * ( (timenow - Non_Infective_Time) / (ownIncubationPeriod - Non_Infective_Time) )
    ]
    if timenow > ownIncubationPeriod [
      set currentVirulence variantTransMult * personalVirulence * ( ( ownIllnessPeriod - timenow ) / ( ownIllnessPeriod - ownIncubationPeriod ))
    ]
  ]
  [
    set currentVirulence 0
  ]



